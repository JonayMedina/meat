{% import "@SyliusShop/Common/Macro/money.html.twig" as money %}

{% set product = item.product %}
{% set product_variant = item.variant %}
{% set available = true %}

{% if product.variants.first.onHand < 1 %}
    {% set available = false %}
{% endif %}


<div class="col-12 product-item favorite-item view {{ get_principal_taxon(product.mainTaxon).code }} product-{{ product.id }} {{ product.name|lower|replace({' ': '-'}) }}">
    <div class="row">
        <div class="col-12 col-sm-12 col-md-5 col-lg-5">
            <div class="row p-{{ product.id }}">
                <div class="col-12 col-sm-12 col-md-12 col-lg-3 md-pb-1">
                    <div class="row">
                        <div class="col-6 col-sm-6 col-md-6 col-lg-12 image-container">
                            <a class="d-block image {% if not available %}sold-out{% endif %}" {% if available %}href="{{ path('sylius_shop_product_show', {'slug': product.slug, '_locale': product.translation.locale}) }}"{% endif %} style="background: url('{{ product.images.first.path|imagine_filter('sylius_shop_product_thumbnail') }}')">
                                <img src="{{ product.images.first.path|imagine_filter('sylius_shop_product_thumbnail') }}" alt="{{ product.name }}" title="{{ product.name }}" width="auto" height="auto">
                                {% if not available %}
                                    <div class="sold-out">{{ 'app.ui.sold_out'|trans }}</div>
                                {% endif %}
                            </a>
                        </div>
                        <div class="col-6 col-sm-6 col-md-6 col-lg-12 delete-content d-flex d-lg-none">
                            <a class="delete hvr-icon-buzz-out" data-id="{{ product.id }}"><span>{{ 'app.ui.favorites.delete'|trans|raw }}</span> <img class="hvr-icon" src="{{ asset('bundles/syliusshop/img/icons/trash.svg') }}" alt="{{ 'app.ui.favorites.delete'|trans }}" title="{{ 'app.ui.favorites.delete'|trans }}" width="auto" height="auto"></a>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-9">
                    <a class="name" {% if available %}href="{{ path('sylius_shop_product_show', {'slug': product.slug, '_locale': product.translation.locale}) }}"{% endif %}><p class="product-name">{{ product.name }}</p></a>
                    <div class="price">
                        {{ 'app.ui.produc.%price%_peer_%measure%'|trans({'%price%': '<span>' ~ money.calculatePrice(product|sylius_resolve_variant) ~ '</span>', '%measure%': 'app.ui.pound'|trans})|raw }}
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 col-sm-12 col-md-7 col-lg-7 sm-pt-1">
            <div class="row">
                <div class="col-12 col-sm-12 col-md-12 col-lg-9">
                    <form id="price" data-price="{{ money.calculatePrice(product|sylius_resolve_variant) }}">
                        <div class="required field {% if not available %}invisible{% endif %}">
                            {{ form_label(form.quantity) }}
                            {{ form_errors(form.quantity) }}
                            <div class="quantity">
                                {{ form_widget(form.quantity, {'attr': {'form': main_form}}) }}
                            </div>
                            <p class="type">{{ 'app.ui.express_buy.package'|trans }}</p>
                        </div>

                        <div>
                            <p class="sub-total-title">{{ 'app.ui.sub_total'|trans }}</p>
                            <p class="sub-total">{{ money.calculatePrice(product|sylius_resolve_variant) }}</p>
                        </div>
                    </form>
{#                    {{ render(url('sylius_shop_partial_cart_add_item', {'template': '@SyliusShop/Product/Show/_addToCartWithSubTotal.html.twig', 'productId': product.id})) }}#}
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-3 delete-content d-none d-md-none d-lg-flex">
                    <a class="delete hvr-icon-buzz-out" data-id="{{ product.id }}"><span>{{ 'app.ui.favorites.delete'|trans|raw }}</span> <img class="hvr-icon" src="{{ asset('bundles/syliusshop/img/icons/trash.svg') }}" alt="{{ 'app.ui.favorites.delete'|trans }}" title="{{ 'app.ui.favorites.delete'|trans }}" width="auto" height="auto"></a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="divider product-{{ product.id }} {{ get_principal_taxon(product.mainTaxon).code }} {{ product.name|lower|replace({' ': '-'}) }}"></div>

{#<tr>#}
{#    <td class="single line">#}
{#        {% include '@SyliusShop/Product/_info.html.twig' with {'variant': product_variant} %}#}
{#    </td>#}
{#    <td class="right aligned">#}
{#        {% if item.unitPrice != item.discountedUnitPrice %}#}
{#            <span class="sylius-regular-unit-price">#}
{#                <span class="old-price">{{ money.convertAndFormat(item.unitPrice) }}</span>#}
{#            </span>#}
{#        {% endif %}#}
{#        <span class="sylius-unit-price">{{ money.convertAndFormat(item.discountedUnitPrice) }}</span>#}
{#    </td>#}
{#    <td class="center aligned">#}
{#        <span class="sylius-quantity ui form">{{ form_widget(form.quantity, {'attr': {'form': main_form}}) }}</span>#}
{#    </td>#}
{#    <td class="center aligned">#}
{#        <form action="{{ path('sylius_shop_cart_item_remove', {'id': item.id}) }}" method="post">#}
{#            <input type="hidden" name="_method" value="DELETE" />#}
{#            <input type="hidden" name="_csrf_token" value="{{ csrf_token(item.id) }}" />#}
{#            <button type="submit" class="ui circular icon button sylius-cart-remove-button" ><i class="remove icon"></i></button>#}
{#        </form>#}
{#    </td>#}
{#    <td class="right aligned">#}
{#        <span class="sylius-total">{{ money.convertAndFormat(item.subtotal) }}</span>#}
{#    </td>#}
{#</tr>#}
